#!/bin/sh
set -e

echo "ğŸš€ Running pre-push checks..."

# Run full test suite before push
echo "ğŸ§ª Running full test suite..."
if command -v cargo-nextest &> /dev/null; then
    cargo nextest run
else
    cargo test
fi
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed. Push aborted."
    exit 1
fi

# Check documentation
echo "ğŸ“š Checking documentation..."
cargo doc --no-deps --quiet
if [ $? -ne 0 ]; then
    echo "âŒ Documentation build failed. Push aborted."
    exit 1
fi

echo "âœ… All pre-push checks passed! Pushing..."